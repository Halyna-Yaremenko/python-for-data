# python-for-data


## üìä –ê–Ω–∞–ª—ñ–∑ –¥–∞—Ç–∞—Å–µ—Ç—É —Ñ—ñ–ª—å–º—ñ–≤ —ñ–∑ movies_metadata.csv

–¶—è –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∏–∫–æ–Ω—É—î –±–∞–∑–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö —ñ–∑ —Ñ–∞–π–ª—É movies_metadata.csv, –æ—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö, –æ–±—Ä–æ–±–∫—É –∂–∞–Ω—Ä—ñ–≤ —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö –∂–∞–Ω—Ä—ñ–≤ —É –≤–∏–≥–ª—è–¥—ñ –±–∞—Ä–ø–ª–æ—Ç—É.


## –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫ —Ç–∞ –¥–∞–Ω–∏—Ö

–£ –ø—Ä–æ–µ–∫—Ç—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ç–∞–∫—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏:

- **pandas** ‚Äî —Ä–æ–±–æ—Ç–∞ –∑ —Ç–∞–±–ª–∏—Ü—è–º–∏  
- **numpy** ‚Äî —Ä–æ–±–æ—Ç–∞ –∑ –º–∞—Å–∏–≤–∞–º–∏  
- **matplotlib** —ñ **seaborn** ‚Äî –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è  
- **ast** ‚Äî –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó —Ä—è–¥–∫—ñ–≤ —É Python-—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ (–¥–ª—è –∂–∞–Ω—Ä—ñ–≤)

–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:

    df = pd.read_csv("data/movies_metadata.csv")

–î–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –∑ —Ñ–∞–π–ª—É:

    df = pd.read_csv("data/movies_metadata.csv")

```python
–§–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å 45466 —Ä—è–¥–∫—ñ–≤ —ñ 24 —Å—Ç–æ–≤–ø—Ü—ñ:

RangeIndex: 45466 entries, 0 to 45465
Data columns (total 24 columns):
 #   Column                 Non-Null Count  Dtype  
---  ------                 --------------  -----  
 0   adult                  45466 non-null  object 
 1   belongs_to_collection  45466 non-null  object 
 2   budget                 45466 non-null  object 
 3   genres                 45466 non-null  object 
 4   homepage               45466 non-null  object 
 5   id                     45466 non-null  object 
 6   imdb_id                45449 non-null  object 
 7   original_language      45455 non-null  object 
 8   original_title         45466 non-null  object 
 9   overview               44512 non-null  object 
 10  popularity             45461 non-null  object 
 11  poster_path            45080 non-null  object 
 12  production_companies   45463 non-null  object 
 13  production_countries   45463 non-null  object 
 14  release_date           45379 non-null  object 
 15  revenue                45460 non-null  float64
 16  runtime                45203 non-null  float64
 17  spoken_languages       45460 non-null  object 
 18  status                 45379 non-null  object 
 19  tagline                45466 non-null  object 
 20  title                  45460 non-null  object 
 21  video                  45460 non-null  object 
 22  vote_average           45460 non-null  float64
 23  vote_count             45460 non-null  float64

```
## –û–≥–ª—è–¥ —Ç–∞ –æ—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É Pandas

###  1. –ë–∞–∑–æ–≤–∏–π –ø–µ—Ä–µ–≥–ª—è–¥ –¥–∞–Ω–∏—Ö

df.head() üëâ –í–∏–≤–æ–¥–∏—Ç—å –ø–µ—Ä—à—ñ 5 —Ä—è–¥–∫—ñ–≤ DataFrame

df.info() üëâ –ü–æ–∫–∞–∑—É—î –∑–∞–≥–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ DataFrame (–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤/—Å—Ç–æ–≤–ø—Ü—ñ–≤, —Ç–∏–ø–∏ –¥–∞–Ω–∏—Ö, –ø—Ä–æ–ø—É—Å–∫–∏, –ø–∞–º º—è—Ç—å)

df.describe() üëâ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –æ–ø–∏—Å —á–∏—Å–ª–æ–≤–∏—Ö —Å—Ç–æ–≤–ø—Ü—ñ–≤: —Å–µ—Ä–µ–¥–Ω—î, –º—ñ–Ω—ñ–º—É–º, –º–∞–∫—Å–∏–º—É–º, –∫–≤–∞—Ä—Ç–∏–ª—ñ

df.isnull().sum() üëâ –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É —Å—Ç–æ–≤–ø—Ü—ñ (–≤–∞–∂–ª–∏–≤–æ –ø–µ—Ä–µ–¥ –æ—á–∏—â–µ–Ω–Ω—è–º)

### 2. –ü–µ—Ä–≤–∏–Ω–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö

–£ —Ü—å–æ–º—É –±–ª–æ—Ü—ñ –∫–æ–¥—É –º–∏ –∑–∞–ø–æ–≤–Ω—é—î–º–æ –ø—Ä–æ–ø—É—â–µ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è (NaN) —É –¥–≤–æ—Ö —Å—Ç–æ–≤–ø—Ü—è—Ö DataFrame, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–æ–º–∏–ª–æ–∫ –ø—ñ–¥ —á–∞—Å –∞–Ω–∞–ª—ñ–∑—É –∞–±–æ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó.

‚úîÔ∏è –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ø—Ä–æ–ø—É—Å–∫—ñ–≤ —É —Å—Ç–æ–≤–ø—Ü—ñ tagline
    
    df["tagline"].fillna("without tagline")

–ó–∞–ø–æ–≤–Ω—é—î –≤—Å—ñ –ø–æ—Ä–æ–∂–Ω—ñ (NaN) –∑–Ω–∞—á–µ–Ω–Ω—è —É —Å—Ç–æ–≤–ø—Ü—ñ tagline. 
–Ø–∫—â–æ —É —Ñ—ñ–ª—å–º—É –Ω–µ–º–∞—î —Å–ª–æ–≥–∞–Ω—É ‚Äî –º–∏ –ø—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ "without tagline". 
–¶–µ –¥–æ–∑–≤–æ–ª—è—î —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä–æ–ø—É—Å–∫—ñ–≤, —è–∫—ñ –º–æ–∂—É—Ç—å –∑–ª–∞–º–∞—Ç–∏ –ø–æ–¥–∞–ª—å—à–∏–π –∞–Ω–∞–ª—ñ–∑ —Ç–µ–∫—Å—Ç—É.

‚úîÔ∏è –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ø—Ä–æ–ø—É—Å–∫—ñ–≤ —É homepage

    df.homepage.fillna("no homepage")

–ó–∞–º—ñ–Ω—é—î –≤—Å—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ URL —É —Å—Ç–æ–≤–ø—Ü—ñ homepage –∑–Ω–∞—á–µ–Ω–Ω—è–º "no homepage". –î–æ–∑–≤–æ–ª—è—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ —ñ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–æ–ø—É—â–µ–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏.

‚úîÔ∏è –í–∏–¥–∞–ª–µ–Ω–Ω—è —Ä—è–¥–∫—ñ–≤ —ñ–∑ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏

    df.dropna(inplace=True)

–í–∏–¥–∞–ª—è—î –≤—Å—ñ —Ä—è–¥–∫–∏, —â–æ –º—ñ—Å—Ç—è—Ç—å —Ö–æ—á–∞ –± –æ–¥–∏–Ω NaN.
inplace=True –æ–∑–Ω–∞—á–∞—î, —â–æ DataFrame –∑–º—ñ–Ω—é—î—Ç—å—Å—è –±–µ–∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–ø—ñ—ó.

### 3. –û–±—Ä–æ–±–∫–∞ –∂–∞–Ω—Ä—ñ–≤

–§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è JSON-—Ä—è–¥–∫—ñ–≤ —É —Å–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä—ñ–≤

    def extract_genres(genre_str):
        try:
            genres = ast.literal_eval(genre_str)
            return [genre["name"] for genre in genres]
        except ValueError:
            return []

–ü–æ—è—Å–Ω–µ–Ω–Ω—è

 - genre_str ‚Äî —Ç–µ–∫—Å—Ç —É –≤–∏–≥–ª—è–¥—ñ
"[{'id': 18, 'name': 'Drama'}, ...]".

 - ast.literal_eval() –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î —Ç–µ–∫—Å—Ç —É —Å–ø—Ä–∞–≤–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–Ω–∏–∫—ñ–≤.

 - –§—É–Ω–∫—Ü—ñ—è –ø–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –Ω–∞–∑–≤ –∂–∞–Ω—Ä—ñ–≤:
["Drama", "Action", "Comedy"].

 - –Ø–∫—â–æ —Ñ–æ—Ä–º–∞—Ç –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π (except ValueError:) ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –ø—É—Å—Ç–∏–π —Å–ø–∏—Å–æ–∫.

 - df["genres"] = df["genres"].apply(extract_genres)
–ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é extract_genres –¥–æ –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞ —Å—Ç–æ–≤–ø—Ü—è genres. –ó–∞–º—ñ—â—É—î–º–æ —Å—Ç–∞—Ä–∏–π —Å—Ç–æ–≤–ø–µ—Ü—å genres –Ω–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏: —Ç–µ–ø–µ—Ä –∫–æ–∂–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç ‚Äî —Ü–µ —Å–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä—ñ–≤, –∞ –Ω–µ —Ä—è–¥–æ–∫.

 - all_genres = df['genres'].explode()
genres_counts = all_genres.value_counts()
–†–æ–∑–ø–∞–∫–æ–≤—É—î–º–æ —Å–ø–∏—Å–∫–∏ –∂–∞–Ω—Ä—ñ–≤ —É —Å—Ç–æ–≤–ø—Ü—ñ genres_counts = all_genres.value_counts() - –ü—ñ–¥—Ä–∞—Ö–æ–≤—É—î–º–æ, —Å–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è –∫–æ–∂–Ω–∏–π –∂–∞–Ω—Ä.

- explode() —Ä–æ–∑–ø–∞–∫–æ–≤—É—î —Å–ø–∏—Å–∫–∏.

- value_counts() —Ä–∞—Ö—É—î, —Å–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è –∫–æ–∂–Ω–∏–π –∂–∞–Ω—Ä.

- print(genres_counts.index)   # –Ω–∞–∑–≤–∏ –∂–∞–Ω—Ä—ñ–≤
- print(genres_counts.values)  # –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ—ñ–ª—å–º—ñ–≤

### 4. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—ñ –∂–∞–Ω—Ä—ñ–≤

–°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –±–∞—Ä–ø–ª–æ—Ç —ñ–∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ñ—ñ–ª—å–º—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É –∂–∞–Ω—Ä—ñ:

–ü–æ–±—É–¥–æ–≤–∞ —Å—Ç–æ–≤–ø—á–∏–∫–æ–≤–æ—ó –¥—ñ–∞–≥—Ä–∞–º–∏

    plt.figure(figsize=(10,6))

–°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤—É —Ñ—ñ–≥—É—Ä—É (–ø–æ–ª–æ—Ç–Ω–æ) –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫–∞.

    sns.barplot(x=genres_counts.index, y=genres_counts.values)

–ë—É–¥—É—î–º–æ —Å—Ç–æ–≤–ø—á–∏–∫–æ–≤—É –¥—ñ–∞–≥—Ä–∞–º—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Seaborn.
x=genres_counts.index ‚Äî –Ω–∞–∑–≤–∏ –∂–∞–Ω—Ä—ñ–≤ (Drama, Comedy, Action‚Ä¶). 
y=genres_counts.values ‚Äî –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ—ñ–ª—å–º—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∂–∞–Ω—Ä—É.

    plt.title("Count film for genres")
    plt.xlabel("genres")
    plt.ylabel("counts")

    plt.xticks(rotation=45)
–ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø—ñ–¥–ø–∏—Å–∏ –∂–∞–Ω—Ä—ñ–≤ –Ω–∞ 45¬∞, —â–æ–± –≤–æ–Ω–∏ –Ω–µ –Ω–∞–∫–ª–∞–¥–∞–ª–∏—Å—è –æ–¥–∏–Ω –Ω–∞ –æ–¥–Ω–æ–≥–æ —Ç–∞ –±—É–ª–∏ —á–∏—Ç–∞–±–µ–ª—å–Ω–∏–º–∏.

    plt.show()
–í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ –≥—Ä–∞—Ñ—ñ–∫ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ

barplot –ø–æ–∫–∞–∑—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ—ñ–ª—å–º—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É –∂–∞–Ω—Ä—ñ.

![alt text](image.png)